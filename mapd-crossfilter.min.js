function createDateAsUTC(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()))}!function(n){function e(n){function e(){var n=null,e=Number.MAX_SAFE_INTEGER;for(key in a)a[key].time<e&&(n=key,e=a[key].time);delete a[n]}function r(){return a={},l}function t(n,r,t,i,l){var s=Object.keys(a).length;if(!t){if(n in a)return a[n].time=f++,void u(n,void 0,!t,a[n].data,l);s>=o&&e()}return l.push(u.bind(this,n,i,!t)),c.queryAsync(n,!0,r,t,l)}function u(n,e,r,t,u){if(r){if(void 0===e)a[n]={time:f++,data:t};else{for(var i=t,l=0;l<e.length;l++)i=e[l](t);a[n]={time:f++,data:i}}u.pop()(a[n].data,u)}else if(void 0===e)u.pop()(t,u);else{for(var i=t,l=0;l<e.length;l++)i=e[l](t);u.pop()(i,u)}}function i(n,r,t,u){var i=Object.keys(a).length;if(!t){if(n in a)return a[n].time=f++,a[n].data;i>=o&&e()}var l=null;if(void 0===u)l=c.query(n,!0,r,t),t||(a[n]={time:f++,data:l});else{l=c.query(n,!0,r,t);for(var s=0;s<u.length;s++)l=u[s](l);t||(a[n]={time:f++,data:l})}return l}var l={query:i,queryAsync:t,emptyCache:r,setMaxCacheSize:function(n){o=n},setDataConnector:function(n){c=n}},o=10,a={},f=0,c=null;return c=n,l}function r(){function n(n){return p[typeof n]||p[S.call(n)]||(n?"object":"null")}function r(n,r,t){y=n,h=e(y),c=r,d=t;var u=y.getFields(c);return v={},u.forEach(function(n){v[n.name]={type:n.type,is_array:n.is_array,is_dict:n.is_dict}}),f}function t(){return v}function u(){var n="",e=!0;return $(s).each(function(r,t){null!=t&&""!=t&&(e||(n+=" AND "),e=!1,n+=t)}),n}function i(){function n(){return g=g==u?null:u,r}function e(){return s[u]}function r(n){return void 0==n||null==n?t():s[u]=n,r}function t(){return s[u]="",r}var r={filter:r,filterAll:t,getFilter:e,toggleTarget:n},u=s.length;return s.push(""),r}function l(r){function t(n){return arguments.length?(U=n,L):U}function u(){g=g==_?null:_}function i(){g==_&&(g=null)}function l(){return g==_}function a(n){return w=n,L}function d(n){return H=n,L}function h(){return j}function p(){return s[_]}function S(n,e,r){return e="undefined"!=typeof e?e:!1,null==n?F():Array.isArray(n)&&!K?b(n,e,r):"function"==typeof n?filterFunction(n,e):T(n,e)}function A(e){var r=n(e);return"string"==r?"'"+e+"'":"date"==r?"TIMESTAMP(0) '"+e.toISOString().slice(0,19).replace("T"," ")+"'":e}function T(n,e){var r=Array.isArray(n);r||(n=[n]);for(var t="",u=0;u<n.length;u++){u>0&&(t+=" AND ");var i=A(n[u]);t+=W[u]?i+" = ANY "+X[u]:X[u]+" = "+i}return e="undefined"!=typeof e?e:!1,e?s[_]+=t:s[_]=t,L}function E(n,e){e="undefined"!=typeof e?e:!1,e?s[_]+=J+" like '%"+n+"%'":s[_]=J+" like '%"+n+"%'"}function D(n){append="undefined"!=typeof append?append:!1,append?s[_]+=J+" ilike '%"+n+"%'":s[_]=J+" ilike '%"+n+"%'"}function b(n,e,r){var t=Array.isArray(n[0]);t||(n=[n]),j=n;for(var u="",i=0;i<n.length;i++){1==r&&(G[i]=n[i]),i>0&&(u+=" AND ");var l=[A(n[i][0]),A(n[i][1])];u+=X[i]+" >= "+l[0]+" AND "+X[i]+" < "+l[1]}return e="undefined"!=typeof e?e:!1,e?s[_]+="("+u+")":s[_]="("+u+")",L}function O(n,e){var r=null==s[_]||""==s[_],t=!1;void 0!==e&&(t=e,1==t&&$(L).trigger("reranged"));var u=n.length-1;s[_]="(";for(var i=0;u>=i;i++){var l=n[i];S(l,!0,t),i!=u&&(V?s[_]+=" AND ":s[_]+=" OR ")}s[_]+=")";var o=null==s[_]||""==s[_];return r&&!o?$(this).trigger("filter-on"):!r&&o&&$(this).trigger("filter-clear"),L}function F(n){return(void 0==n||0==n)&&($(this).trigger("filter-clear"),G=[]),j=null,s[_]="",L}function C(n){var e="";if(H){for(var r=f.getDimensions(),t=[],u=0;u<r.length;u++)null!=r[u]&&t.push(r[u]);t=t.concat(w);for(var i={},u=0;u<t.length;u++)t[u]in i||(i[t[u]]=null);t=[];for(key in i)t.push(key);e=t.join(",")}else e=w.join(",");if(""!==e){n&&(e+=",rowid");for(var l="SELECT "+e+" FROM "+c,o="",a=0,g=0;g<s.length;g++)s[g]&&""!=s[g]&&(a>0&&(o+=" AND "),a++,o+=s[g]);if(""!=o&&(l+=" WHERE "+o),null!==N&&1>N){l+=o?" AND ":" WHERE ";var v=Math.floor(4294967296*N);l+=" rowid * 265445761 % 4294967296 < "+v}return l}}function N(n){return n||(N=null),N=n,L}function R(n,e,r){var t=C(!!r);return null==t?{}:null!=J?(t+=" ORDER BY "+J,n!==1/0&&(t+=" LIMIT "+n),z.query(t,!1)):(n!==1/0&&(t+=" LIMIT "+n),P=z.query(t,!1,r))}function M(n,e,r,t){var u=C(!!r);return null==u?{}:null!==J?(u+=" ORDER BY "+J,n!==1/0&&(u+=" LIMIT "+n),void 0!==e&&(u+=" OFFSET "+e),z.queryAsync(u,!1,r,void 0,t)):(n!==1/0&&(u+=" LIMIT "+n),void 0!==e&&(u+=" OFFSET "+e),r||t.push(B.bind(this)),z.queryAsync(u,!1,r,void 0,t))}function I(n,e){var r=C();return null==r?{}:null!=J?(r+=" ORDER BY "+J+" DESC LIMIT "+n,void 0!==e&&(r+=" OFFSET "+e),z.query(r,!1)):(r+=" LIMIT "+n,void 0!==e&&(r+=" OFFSET "+e),P=z.query(r,!1))}function q(n,e,r,t){var u=C();return null==u?{}:null!=J?(u+=" ORDER BY "+J+" DESC LIMIT "+n,void 0!==e&&(u+=" OFFSET "+e),z.queryAsync(u,!1,r,void 0,t)):(u+=" LIMIT "+n,void 0!==e&&(u+=" OFFSET "+e),t.push(B.bind(this)),z.queryAsync(u,!1,r,void 0,t))}function B(n,e){P=n,e.pop()(n,e)}function k(){function r(n){for(var e="",r=0,t=0;t<s.length;t++)if(t==_&&1!=V||U&&t==g||!s[t]||!(s[t].length>0)){if(t==_&&null!=n){var u="";r>0&&(u+=" AND "),r++;for(var i=!1,l=0;l<X.length;l++)if(null!==n[l]){var o=n[l].binBounds;1==L&&G.length>0&&(o=G[l]),l>0&&i&&(u+=" AND "),i=!0,u+="("+X[l]+" >= "+A(o[0])+" AND "+X[l]+" < "+A(o[1])+")"}i&&(e+=u)}}else r>0&&""!=e&&(e+=" AND "),r++,e+=s[t];return e}function t(e,r,t,i){var l="date"==n(r[0]);if(l){if(i){Q="auto"===i?u([r[0].getTime(),r[1].getTime()],t):i;var o="date_trunc("+Q+","+e+")";return o}var a="extract(epoch from "+e+")",f=.001*(r[1].getTime()-r[0].getTime()),c=(t/f).toFixed(9),s=r[0].getTime()/1e3,o="cast(("+a+" - "+s+") *"+c+" as int)";return o}var f=r[1]-r[0],c=(t/f).toFixed(9),o="cast(("+e+" - "+r[0]+") *"+c+" as int)";return o}function u(n,e){for(var r=[.001*n[0],.001*n[1]],t=r[1]-r[0],u=[{label:"second",numSeconds:1},{label:"minute",numSeconds:60},{label:"hour",numSeconds:3600},{label:"day",numSeconds:86400},{label:"week",numSeconds:604800},{label:"month",numSeconds:2592e3},{label:"quarter",numSeconds:10368e3},{label:"year",numSeconds:31536e3},{label:"decade",numSeconds:31536e4}],i=0;i<u.length;i++)if(t/u[i].numSeconds<e)return u[i].label;return"century"}function i(n){var e=null;q&&U&&(null!==g||g!==H)&&(null!==g&&""!==s[g]&&g!==_?$(M).trigger("targeted",[s[g]]):$(M).trigger("untargeted"),C(q),H=g);var u=null;if(null!==n){e="SELECT ";for(var i=0;i<X.length;i++)if(null!==n[i]){var l=L&&G.length>0?G[i]:n[i].binBounds,u=t(X[i],l,n[i].numBins,J);e+=u+" as key"+i.toString()+","}else if(J){var u=t(X[i],void 0,void 0,J);e+=u+" as key"+i.toString()+","}else e+=X[i]+" as key"+i.toString()+",";e+=I+" FROM "+c}else{for(var o="",i=0;i<X.length;i++)0!=i&&(o+=","),o+=W[i]?"UNNEST("+X[i]+")":X[i],o+=" as key"+i.toString();e="SELECT "+o+", "+I+" FROM "+c}var a=r(n);""!=a&&(e+=" WHERE "+a),e+=" GROUP BY ";for(var f=0;f<X.length;f++)0!=f&&(e+=", "),e+="key"+f.toString();if(null!==n)if("mapd"==y.getPlatform())for(var v=" HAVING ",d=!1,i=0;i<n.length;i++)null!==n[i]&&(i>0&&d&&(v+=" AND "),d=!0,v+="key"+i.toString()+" >= 0 AND key"+i.toString()+" < "+n[i].numBins),d&&!J&&(e+=v);else for(var i=0;i<n.length;i++)null!==n[i]&&(e+=" HAVING "+u+" >= 0 AND "+u+" < "+n[i].numBins);else"mapd"==y.getPlatform();return e}function l(n){return L=n,M}function o(n){if(Array.isArray(n)||(n=[n]),n.length!=x.length)throw"Num bins length must be same as bin params length";for(var e=0;e<n.length;e++)x[e].numBins=n[e];return M}function a(n){return x=n,Array.isArray(x)||(x=[x]),M}function f(n){return j=n,binCount=binCountIn,M}function v(e,r){if(J)return r;for(var t=r.length,u=0;u<e.length;u++)if(null!==e[u]){var i=e[u].binBounds,l=e[u].numBins;L&&G.length>0&&(i=G[u]);var o="key"+u.toString(),a="date"==n(i[u]);if(a)if(null!==z)for(var f=1e3*z.offset,c=(i[1].getTime()-f)/z.numBins,s=0;t>s;++s)r[s][o]=new Date(r[s][o]*c+f);else for(var c=(i[1].getTime()-i[0].getTime())/l,g=i[0].getTime(),s=0;t>s;++s)r[s][o]=new Date(r[s][o]*c+g);else for(var c=(i[1]-i[0])/l,s=0;t>s;++s)r[s][o]=r[s][o]*c+i[0]}return r}function d(n){return nn=n,M}function m(){return nn=null,M}function h(){var n=$.extend([],x);n.length||(n=null);var e=i(n);e+=" ORDER BY ";for(var r=0;r<X.length;r++)r>0&&(e+=","),e+="key"+r.toString();return null!=n?w.query(e,Z,void 0,[v.bind(this,n)]):w.query(e,Z,void 0)}function p(n){var e=$.extend([],x);e.length||(e=null);var r=i(e);r+=" ORDER BY ";for(var t=0;t<X.length;t++)t>0&&(r+=","),r+="key"+t.toString();null!=e?w.queryAsync(r,Z,void 0,[v.bind(this,e)],n):w.queryAsync(r,Z,void 0,void 0,n)}function S(n,e){var r=i(null);if(r+=" ORDER BY ",nn)r+=nn+" DESC";else{for(var t=B.split(","),u=t.length,l=0;u-1>l;l++)r+=t[l]+" DESC,";r+=t[u-1]+" DESC"}return n!=1/0&&(r+=" LIMIT "+n),void 0!==e&&(r+=" OFFSET "+e),w.query(r,Z)}function T(n,e,r,t){var u=i(null);if(u+=" ORDER BY ",nn)u+=nn+" DESC";else{for(var l=B.split(","),o=l.length,a=0;o-1>a;a++)u+=l[a]+" DESC,";u+=l[o-1]+" DESC"}n!=1/0&&(u+=" LIMIT "+n),void 0!==e&&(u+=" OFFSET "+e),w.queryAsync(u,Z,void 0,void 0,t)}function E(){return C([{expression:"*",agg_mode:"count",name:"value"}]),M}function D(n){return C([{expression:n,agg_mode:"sum",name:"value"}]),M}function b(n){return C([{expression:n,agg_mode:"avg",name:"value"}]),M}function O(n){return C([{expression:n,agg_mode:"min",name:"value"}]),M}function F(n){return C([{expression:n,agg_mode:"max",name:"value"}]),M}function C(n){q=n,I="",B="";for(var e=n.length,r=0;e>r;r++){if(r>0&&(I+=",",B+=","),r==P&&null!=g&&g!=_&&""!=s[g])I+="AVG(CAST("+s[g]+" AS INT))";else{var t=n[r].agg_mode.toUpperCase();I+="COUNT"==t?"COUNT(*)":t+"("+n[r].expression+")"}I+=" AS "+n[r].name,B+=n[r].name}return M}function N(n){return k=n,M}function R(n){for(var e="SELECT ",t=0;t<X.length;t++)t>0&&(e+=","),e+="COUNT(DISTINCT "+X[t]+") AS n",K&&(e+=t.toString());if(e+=" FROM "+c,!n){var u=jquery.extend([],x);u.length||(u=null);var i=r(u);""!=i&&(e+=" WHERE "+i)}if(K){for(var l=y.query(e)[0],o=[],t=0;t<X.length;t++){var a="n"+t.toString();o.push(l[a])}return o}return y.query(e)[0].n}var M={order:d,orderNatural:m,top:S,topAsync:T,all:h,allAsync:p,setBinParams:a,numBins:o,truncDate:f,reduceCount:E,reduceSum:D,reduceAvg:b,reduceMin:O,reduceMax:F,reduceMulti:C,setBoundByFilter:l,setTargetSlot:function(n){P=n},getTargetSlot:function(){return P},having:N,size:R,setEliminateNull:function(n){Z=n},binByTimeUnit:function(n){return arguments.length?(J=n,M):J},actualTimeBin:function(){var n=$.extend([],x);if(n.length||(n=null),"auto"===J&&null!==n)for(var e=0;e<X.length;e++){var r=L&&G.length>0?G[e]:n[e].binBounds;Q=u([r[0].getTime(),r[1].getTime()],n[e].numBins)}return Q},writeFilter:r},I=null,q=null,B=null,k=null,x=null,L=!1,j=null,w=e(y),H=null,P=0,z=null,J=null,Q=null,Z=!0,nn=null;return Y.push(M),E()}function x(){s[_]=null,m[_]=null}var L={type:"dimension",filter:S,filterExact:T,filterRange:b,filterAll:F,filterMulti:O,filterLike:E,filterILike:D,getFilter:h,getFilterString:p,projectOn:a,getProjectOn:function(){return w},projectOnAllDimensions:d,getResultSet:function(){return P},samplingRatio:N,top:R,topAsync:M,bottom:I,bottomAsync:q,group:k,groupAll:o,toggleTarget:u,removeTarget:i,allowTargeted:t,isTargeting:l,dispose:x,remove:x,value:function(){return X},setDrillDownFilter:function(n){return V=n,L}},j=null,U=!0,_=s.length,Y=[];s.push("");var w=[],H=!1,G=[],P=null,W=[],V=!1,z=e(y),X=[],J=null,N=null,K=Array.isArray(r);K?X=r:null!==r&&(X=[r]),X.length>0&&(J="");for(var Q=0;Q<X.length;Q++)0!=Q&&(J+=", "),J+=X[Q];m.push(J);for(var Z=0;Z<X.length;Z++)X[Z]in v?W[Z]=v[X[Z]].is_array:W[Z]=!1;return L}function o(){function n(){for(var n="",e=0,r=0;r<s.length;r++)s[r]&&""!=s[r]&&(e>0&&(n+=" AND "),e++,n+=s[r]);return n}function r(e){var r="SELECT "+m+" FROM "+c;if(!e){var t=n();""!=t&&(r+=" WHERE "+t)}return r}function t(){return m="COUNT(*) as value",d}function u(n){return m="SUM("+n+") as value",d}function i(n){return m="AVG("+n+") as value",d}function l(n){return m="MIN("+n+") as value",d}function o(n){return m="MAX("+n+") as value",d}function a(n){m="";for(var e=n.length,r=0;e>r;r++){r>0&&(m+=",");var t=n[r].agg_mode.toUpperCase();m+="COUNT"==t?"COUNT(*)":t+"("+n[r].expression+")",m+=" AS "+n[r].name}return d}function f(n){var e=r(n);return h.query(e,!1,void 0,[function(n){return n[0].value}])}function g(n){var e=r();h.queryAsync(e,!1,void 0,[function(n){return n[0].value}],n)}function v(n){var e=r(n);return h.query(e,!1,void 0,[function(n){return n[0]}])}var d={reduceCount:t,reduceSum:u,reduceAvg:i,reduceMin:l,reduceMax:o,reduceMulti:a,value:f,valueAsync:g,values:v},m=null,h=e(y);return t()}function a(){var n="SELECT COUNT(*) as n FROM "+c;return h.query(n,!1,void 0,[function(n){return n[0].n}])}var f={type:"crossfilter",setData:r,filter:i,getColumns:t,dimension:l,groupAll:o,size:a,getFilter:function(){return s},getFilterString:u,getDimensions:function(){return m},getTable:function(){return c},getTableLabel:function(){return d}},c=null,s=[],g=null,v=null,d=null,y=null,m=[],h=null,p={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"},S=Object.prototype.toString;return 3==arguments.length?r(arguments[0],arguments[1],arguments[2]):f}r.version="1.3.11",n.resultCache=e,n.crossfilter=r}("undefined"!=typeof exports&&exports||this);